!function(r){"use strict";function e(){r(".epofw_datepicker").length&&r(".epofw_datepicker").datepicker({dateFormat:"dd-mm-yy"}),r(".epofw_timepicker").length&&r(".epofw_timepicker").timepicker({timeFormat:"hh:mm:ss TT"}),r(".epofw_colorpicker").length&&r(".epofw_colorpicker").wpColorPicker()}function c(){jQuery("li .epofw_data_condition").each(function(){var e,t,o,a,n,i,c=r(this).val();"product_qty"!==c&&"date_picker"!==c&&("user_role"!==c?(a=".epofw_condition_data_class_"+c,n="epofw_get_data_based_on_cd",i=c,jQuery(a).each(function(){jQuery(a).select2({ajax:{url:epofw_var.ajaxurl,dataType:"json",delay:250,type:"post",data:function(e){return{value:e.term,current_condition:i,action:n,get_data_based_on_cd_nonce:epofw_var.get_data_based_on_cd_nonce}},processResults:function(e){var o=[];return e&&r.each(e,function(e,t){o.push({id:t[0],text:d(t[1])})}),{results:o}},cache:!0},minimumInputLength:3})})):(e=".epofw_condition_data_class_"+c,t="epofw_get_data_based_on_cd",o=c,jQuery(e).each(function(){jQuery(e).select2({ajax:{url:epofw_var.ajaxurl,dataType:"json",delay:250,type:"post",data:function(e){return{value:e.term,current_condition:o,action:t,get_data_based_on_cd_nonce:epofw_var.get_data_based_on_cd_nonce}},processResults:function(e){var o=[];return e&&r.each(e,function(e,t){o.push({id:t[0],text:d(t[1])})}),{results:o}},cache:!0}})})))})}function d(e){return e.replace("&#8211;","–").replace("&gt;",">").replace("&lt;","<").replace("&#197;","Å")}function t(){jQuery(".accordion_cls").each(function(){var n=r(this).attr("id");r("#"+n+" .epofw_extra_field_inp .text-class").each(function(){var e,o,a=r(this).attr("id"),t=r("#"+n).find(".epofw_dependent_field").attr("data-required-field");t&&(e=r("#"+n).find(".epofw_dependent_field").attr("id"),t=JSON.parse(t),o=[],t)&&(r.each(t,function(e,t){new RegExp("epofw_"+t[0]+"_[0-9]").test(a)&&("equal_to"===t[1]&&(t[2]===r("#"+a).val()?o.push(!0):o.push(!1)),"not_equal_to"===t[1])&&(t[2]===r("#"+a).val()?o.push(!1):o.push(!0))}),o.length)&&(-1!==jQuery.inArray(!0,o)?r("#"+e).parent().parent().removeClass("epofw_dependent_field_hide"):r("#"+e).parent().parent().addClass("epofw_dependent_field_hide"))})})}e(),r(document).ajaxComplete(function(){e()});var o={init:function(){r(".accordion_ct_div").hide(),c(),t(),r(".tips, .help_tip, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),jQuery(document).on("change","#epofw_type",o.changeFieldType),jQuery(document).on("click","#add-new-opt",o.cloneOptions),jQuery(document).on("click","#remove-opt",o.removeOptions),jQuery(document).on("change",".epofw_data_condition",o.getDataBasedOnCondition),jQuery(document).on("click",".add_field_id",o.cloneFieldOptions),jQuery(document).on("click",".accordion_cls_title .accordion_a_cls",o.accordianACls),jQuery(document).on("click",".accordion_cls_title .accordion_a_cls_remove",o.removeAccordian),jQuery(document).on("click",'input[type="checkbox"].epofw-has-sub',o.enableSubField),jQuery(document).on("click",".epofw_desc_toogle",o.showEpofwDescription),jQuery(document).on("change",".epofw_options_chk_all",o.epofwOptionsChkAll),jQuery(document).on("click",".disable_all_options",o.disableAllOptions),jQuery(document).on("click",".epofw_options_chk",o.epofwSingleOptions),jQuery(document).on("click",".epofw_af_current_field_show_hide",o.epofwAfCurrentFieldShowHide),jQuery(document).on("change",".text-class",o.changeOnFieldInput)},changeOnFieldInput:function(){t()},epofwAfCurrentFieldShowHide:function(){var e=r(this).closest(".accordion_cls").attr("id"),t=jQuery(this).parent().parent().attr("id");this.checked?r("#"+e+" .show_on_"+t).parent().parent().hide():r("#"+e+" .show_on_"+t).parent().parent().show()},epofwSingleOptions:function(){jQuery(".epofw_options_chk_all").is(":checked")||(jQuery(".epofw_options_chk").is(":checked")?r(".disable_all_options").removeClass("hide").addClass("show"):r(".disable_all_options").removeClass("show").addClass("hide"))},disableAllOptions:function(){var e=[];jQuery(".accordion_cls").each(function(){jQuery(this).find(".epofw_chk_data .epofw_options_chk").is(":checked")&&e.push(jQuery(this).attr("data-id"))}),jQuery.ajax({type:"post",url:epofw_var.ajaxurl,data:{action:"epofw_disbale_field_options",get_post_id:epofw_var.get_post_id,field_ids:e,disable_option_nonce:epofw_var.disable_option_nonce},success:function(e){var t;e&&(!0===e.success?window.location.reload():((t=document.createElement("p")).setAttribute("class","error epofw_disable_option_error"),e=document.createTextNode(e.data.msg),t.appendChild(e),document.getElementsByClassName("addon_fields_header")[0].append(t)))},error:function(e){console.log(e)}})},epofwOptionsChkAll:function(){jQuery(this).is(":checked")?(jQuery(".accordion_cls").each(function(){r(".epofw_chk_data .epofw_options_chk").prop("checked",!0)}),r(".disable_all_options").removeClass("hide").addClass("show")):(jQuery(".accordion_cls").each(function(){r(".epofw_chk_data .epofw_options_chk").removeAttr("checked")}),r(".disable_all_options").removeClass("show").addClass("hide"))},showEpofwDescription:function(){r(this).next("p.epofw_description").toggle()},enableSubField:function(){var e=r(this).parent().parent().parent().parent().attr("id"),t=r(this).attr("data-nextfe");jQuery(this).is(":checked")?jQuery("#"+e+" #"+t).show():jQuery("#"+e+" #"+t).hide()},removeAccordian:function(){return confirm("Are you sure want to delete this field")&&r(this).parent().parent().remove(),!1},accordianACls:function(){r(this).parent().toggleClass("active"),r(this).toggleClass("active"),r(this).hasClass("active")?r(this).find("span.dashicons").removeClass("dashicons-arrow-right-alt2").addClass("dashicons-arrow-down-alt2"):r(this).find("span.dashicons").removeClass("dashicons-arrow-down-alt2").addClass("dashicons-arrow-right-alt2"),r(this).parent().next().slideToggle("fast")},cloneFieldOptions:function(){var o=Math.floor(1e9*Math.random()),e=document.getElementsByClassName("accordion_cls"),t=e.length,e=e[t-1],a=e.cloneNode(!0);e.parentNode.appendChild(a),a.setAttribute("id","accordion_"+o),a.setAttribute("data-id",parseInt(e.getAttribute("data-id"))+1),a.querySelector(".addon_fields").setAttribute("id","addon_fields_"+o),a.querySelector(".addon_field").setAttribute("id","addon_field_"+o),a.querySelector(".addon_field").setAttribute("data-id",o),a.querySelector(".heading_nu_title span").textContent=t+1,a.querySelectorAll(".addon_field .text-class").forEach(function(e){var t=e.getAttribute("name").replace(/\d+/,o);e.setAttribute("name",t)}),a.querySelectorAll(".addon_field .default_num_class").forEach(function(e){var t=e.value.replace(/\d+/,Math.floor(1e9*Math.random()));e.value=t})},getDataBasedOnCondition:function(){var e,t,o,a=r(this).parent().parent().attr("id"),n=r(this).parent().parent().attr("data-attr-key"),i=r(this).val();0===r("#"+a+" #epofw_condition_data_"+n).length&&(r("#"+a+" #epofw_condition_input_data_"+n).length&&r("#"+a).find("li.epofw_condition_field_data").html(""),r("#"+a+" #epofw_condition_data_id_"+n).length&&r("#"+a).find("li.epofw_condition_field_data").html(""),a=document.getElementById(a).getElementsByClassName("epofw_condition_field_data")[0],(e=document.createElement("select")).setAttribute("class","epofw_condition_data_class_"+i+" epofw_condition_data_class multiselect2"),e.setAttribute("id","epofw_condition_data_id_"+n),e.setAttribute("name","epofw_data[additional_rule_data]["+n+"][value][]"),e.setAttribute("multiple","multiple"),(n=document.createElement("div")).setAttribute("class","epofw_all_selection_btn"),(o=document.createElement("button")).setAttribute("type","button"),o.setAttribute("class","button select_all_ad"),o.setAttribute("data-cnd",i),t=document.createTextNode("Select All"),o.appendChild(t),n.appendChild(o),(t=document.createElement("button")).setAttribute("type","button"),t.setAttribute("class","button clear_all_ad"),t.setAttribute("data-cnd",i),o=document.createTextNode("Clear All"),t.appendChild(o),n.appendChild(t),a.appendChild(e),a.appendChild(n)),c()},changeFieldType:function(){var e=r(this).val(),t=r(this).parents().parents().parents().parents().attr("data-id"),o=r(this).parents().parents().parents().parents().attr("data-post-id"),a="accordion_"+t;jQuery.ajax({type:"post",url:epofw_var.ajaxurl,data:{action:"epofw_change_field_basedon_type",current_val:e,parent_id:t,get_post_id:o,change_field_nonce:epofw_var.change_field_nonce},success:function(e){r("#"+a+" .fields_h2").remove(""),r("#"+a+" .general_field").remove(),document.getElementById(a).querySelector("#cop_ft_id").insertAdjacentHTML("afterend",e),r(".opt-li").length&&(1<parseInt(r(".opt-li").length)?r(".opt-li:not(:first) .remove-opt-btn").show():r(".opt-li:first .remove-opt-btn").hide()),r('.accordion_cls input[type="checkbox"].epofw-has-sub').each(function(){var e=r(this).attr("data-nextfe");jQuery("#"+a+" #"+e).hide()})},error:function(e){console.log(e)}})},cloneOptions:function(){var e,t=this.parentElement.parentElement.querySelector("div.opt-li:last-child"),o=parseInt(t.id.match(/\d+/g),10)+1,a=t.cloneNode(!0);a.id="opt-li-"+o,a.querySelector(".epofw-cs-colorswitcher")&&(e=a.querySelector(".epofw-cs-colorswitcher").id,r("#"+e).wpColorPicker()),a.querySelectorAll("input").forEach(function(e){e.id="select-opt-value-"+o,e.classList.contains("epofw-cs-colorswitcher")&&(e.id="select-opt-epofw-cs-colorswitcher-"+o)}),r(".remove-opt-btn").show(),t.insertAdjacentElement("afterend",a),r(".opt-li:first .remove-opt-btn").hide(),r(".opt-li:not(:first) .remove-opt-btn").show()},removeOptions:function(){r(this).attr("attr"),r(this).parent().parent().remove()}};r(function(){var e;r(".epofw_hidden_value").length&&r(".epofw_hidden_value").parent().parent().hide(),r(".epofw_condition_data_class_date_picker").length&&r(".epofw_condition_data_class_date_picker").datepicker({dateFormat:"dd-mm-yy"}),r(".addon_fields_accordian_data").sortable({handle:".sortable-icon",axis:"y"}),r(".nested_accordion_data").sortable({handle:".sortable-icon",axis:"y"}),r(".epofw_colorpicker").length&&r(".epofw_colorpicker").wpColorPicker(),r('.accordion_cls input[type="checkbox"].epofw-has-sub').each(function(){var e=r(this).parent().parent().parent().parent().attr("id"),t=r(this).attr("data-nextfe");jQuery(this).is(":checked")?jQuery("#"+e+" #"+t).show():jQuery("#"+e+" #"+t).hide()}),r(".accordion_cls .epofw_af_current_field_show_hide").each(function(){var e=r(this).closest(".accordion_cls").attr("id"),t=jQuery(this).parent().parent().attr("id");this.checked?r("#"+e+" .show_on_"+t).parent().parent().hide():r("#"+e+" .show_on_"+t).parent().parent().show()}),0<r("#epofw_custom_css").length&&(e={lineNumbers:!0,mode:r("#epofw_custom_css").attr("data-mode"),matchBrackets:!0,autoCloseBrackets:!0},CodeMirror.fromTextArea(document.getElementById("epofw_custom_css"),e)),o.init()})}(jQuery);